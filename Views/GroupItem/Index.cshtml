@model IEnumerable<GroupItem>

@{
    var groups = ViewData["Groups"] as List<WebScoringApp.Models.GroupInformation>;
    int index = 0;
}

<h1 class="mb-4">Group Items</h1>

<p>
    <a asp-action="Create" class="btn btn-primary mb-3">+ Create New</a>
</p>

@if (groups != null && groups.Any())
{
    <div class="accordion" id="groupItemsAccordion">
        @foreach (var group in groups)
        {
            var groupItems = Model.Where(i => i.GroupInformationId == group.Id).ToList();
            if (!groupItems.Any()) continue;

            var collapseId = $"collapseGroup{index}";
            var headingId = $"headingGroup{index}";

            <div class="accordion-item shadow-sm mb-2">
                <h2 class="accordion-header" id="@headingId">
                    <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#@collapseId" aria-expanded="false" aria-controls="@collapseId">
                        ðŸ“‚ @group.Name
                    </button>
                </h2>
                <div id="@collapseId" class="accordion-collapse collapse" aria-labelledby="@headingId" data-bs-parent="#groupItemsAccordion">
                    <div class="accordion-body p-0">
                        <table class="table table-striped table-bordered table-hover mb-0">
                            <thead class="table-light">
                                <tr>
                                    <th>Option Name</th>
                                    <th>Bobot %</th>
                                    <th class="text-center" style="width:180px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in groupItems)
                                {
                                    <tr>
                                        <td>@item.Name</td>
                                        <td>@item.BobotD</td>
                                        <td class="text-center">
                                            <a asp-action="Edit" asp-route-id="@item.Id" class="text-primary me-2">Edit</a>
                                            <a asp-action="Details" asp-route-id="@item.Id" class="text-info me-2">Details</a>
                                            <a asp-action="Delete" asp-route-id="@item.Id" class="text-danger">Delete</a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            index++;
        }
    </div>
}
else
{
    <div class="alert alert-info">Tidak ada item yang tersedia.</div>
}
